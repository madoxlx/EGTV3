
> rest-express@1.0.0 dev
> cross-env NODE_ENV=development tsx server/index.ts

Testing database connection...
ğŸ”‘ Google AI API Key status: Found (AIzaSyBLsu...)
ğŸ” Full environment check: {
  hasGoogleAIKey: false,
  hasOldGoogleKey: false,
  hasGeminiKey: false,
  nodeEnv: 'development',
  keyLength: 39,
  usingFallback: true
}
â³ Waiting for database initialization...
Database connection established successfully
âœ… Database initialized.
ğŸ” Setting up admin users...
âŒ Error setting up admin users: error: column "password" does not exist
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:104:19)
    at async setupAdmin (/home/runner/workspace/server/admin-setup.ts:20:27)
    at async <anonymous> (/home/runner/workspace/server/index.ts:128:7) {
  length: 108,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '26',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3722',
  routine: 'errorMissingColumn'
}
âœ… Admin setup completed
âœ… Unified auth setup completed
âœ… Hero slides routes setup completed
ğŸ”§ Setting up upload routes...
âœ… Upload routes and static serving setup completed
ğŸ”§ Setting up upload routes...
âœ… API routes registered successfully
âš ï¸  Skipping automatic database initialization to prevent startup delays
ğŸ’¡ Database is already configured and ready to use
âœ… Vite development setup completed
1:48:25 PM [express] âœ… Server serving on port 8080
ğŸŒ Application available at http://localhost:8080
âœ… Database connection verified
ğŸ”¥ API ROUTE DEBUG: GET /api/menus/location/header
ğŸ”¥ Query params: {}
ğŸ”¥ STORAGE: getMenuByLocation called with location: header
1:48:40 PM [express] GET /api/hero-slides/active 304 in 2ms :: [{"id":1,"title":"Welcome to Sahara Journeys","subtitle":"Discover the Magic of the Middle East","descripâ€¦
ğŸ”¥ API ROUTE DEBUG: GET /api/cities
ğŸ”¥ Query params: {}
ğŸ”¥ API ROUTE DEBUG: GET /api/countries
ğŸ”¥ Query params: {}
ğŸ”¥ API ROUTE DEBUG: GET /api/destinations
ğŸ”¥ Query params: {}
ğŸ”¥ STORAGE: getMenuByLocation query returned: 1 results
ğŸ”¥ STORAGE: Found menu: {"id":1,"name":"Header Menu","location":"header","description":"Main navigation menu","active":true,"createdAt":"2025-07-17T13:24:51.964Z","updatedAt":null}
ğŸ”¥ API ROUTE DEBUG: GET /api/packages
ğŸ”¥ Query params: {}
Error listing menu items: error: column "order_position" does not exist
    at /home/runner/workspace/node_modules/pg/lib/client.js:545:17
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async DatabaseStorage.listMenuItems (/home/runner/workspace/server/storage.ts:1222:16)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:4581:25) {
  length: 114,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '70',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3722',
  routine: 'errorMissingColumn'
}
1:48:41 PM [express] GET /api/menus/location/header 304 in 295ms :: {"menu":{"id":1,"name":"Header Menu","location":"header","description":"Main navigation menu","activâ€¦
ğŸ”¥ API ROUTE DEBUG: GET /api/homepage-sections?active=true
ğŸ”¥ Query params: { active: 'true' }
Error listing countries: error: column "description" does not exist
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:104:19)
    at async DatabaseStorage.listCountries (/home/runner/workspace/server/storage.ts:319:14)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:1175:25) {
  length: 111,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '30',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3722',
  routine: 'errorMissingColumn'
}
1:48:41 PM [express] GET /api/countries 304 in 801ms :: []
Error listing cities: error: column "description" does not exist
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:104:19)
    at async DatabaseStorage.listCities (/home/runner/workspace/server/storage.ts:373:14)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:1228:22) {
  length: 111,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '36',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3722',
  routine: 'errorMissingColumn'
}
1:48:41 PM [express] GET /api/cities 304 in 808ms :: []
Error listing packages: error: column "title" does not exist
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:104:19)
    at async DatabaseStorage.listPackages (/home/runner/workspace/server/storage.ts:545:14)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:574:24) {
  length: 105,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '14',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3722',
  routine: 'errorMissingColumn'
}
1:48:41 PM [express] GET /api/packages 304 in 784ms :: []
ğŸ”¥ API ROUTE DEBUG: GET /api/menus/location/footer
ğŸ”¥ Query params: {}
ğŸ”¥ STORAGE: getMenuByLocation called with location: footer
Error listing homepage sections: error: column "description" does not exist
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:104:19)
    at async DatabaseStorage.listHomepageSections (/home/runner/workspace/server/storage.ts:1002:16)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:6484:24) {
  length: 111,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '35',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3722',
  routine: 'errorMissingColumn'
}
1:48:42 PM [express] GET /api/homepage-sections 304 in 772ms :: []
ğŸ”¥ STORAGE: getMenuByLocation query returned: 1 results
ğŸ”¥ STORAGE: Found menu: {"id":2,"name":"Footer Menu","location":"footer","description":"Footer navigation menu","active":true,"createdAt":"2025-07-17T13:24:51.964Z","updatedAt":null}
Error listing translations: error: column "updated_by" does not exist
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:104:19)
    at async DatabaseStorage.listTranslations (/home/runner/workspace/server/storage.ts:1375:14)
    at async <anonymous> (/home/runner/workspace/server/index.ts:171:30) {
  length: 181,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: 'Perhaps you meant to reference the column "translations.updated_at".',
  position: '108',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3729',
  routine: 'errorMissingColumn'
}
1:48:42 PM [express] GET /api/translations 304 in 813ms :: []
Error listing menu items: error: column "order_position" does not exist
    at /home/runner/workspace/node_modules/pg/lib/client.js:545:17
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async DatabaseStorage.listMenuItems (/home/runner/workspace/server/storage.ts:1222:16)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:4581:25) {
  length: 114,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '70',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3722',
  routine: 'errorMissingColumn'
}
1:48:42 PM [express] GET /api/menus/location/footer 304 in 897ms :: {"menu":{"id":2,"name":"Footer Menu","location":"footer","description":"Footer navigation menu","actâ€¦
1:48:42 PM [express] GET /api/translations/settings 304 in 803ms :: {"defaultLanguage":"en","availableLanguages":["en","ar"],"rtlLanguages":["ar"]}
Error listing destinations: error: column "country" does not exist
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:104:19)
    at async DatabaseStorage.listDestinations (/home/runner/workspace/server/storage.ts:464:14)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:509:28) {
  length: 107,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '22',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3722',
  routine: 'errorMissingColumn'
}
1:48:43 PM [express] GET /api/destinations 304 in 2793ms :: []
1:48:43 PM [express] GET /api/tour-categories 304 in 2816ms :: [{"id":2,"name":"City Tours","description":"Explore urban attractions","created_at":"2025-07-17T13:45:15.â€¦